* 모니터링 툴이 없는 상황에서 어떤 화면이 많이 호출되었는지를 확인하는 것은 쉽지 않다.
* 하지만 웹서버만 있다면 이 문제에 대한 답을 찾을 수도 있다.
* ➡️ **웹 로그(Access log)를 사용하여 시스템을 분석하는 방법**이다.
</br>

## ✏️ 웹 로그란?
* 아파치나 Nginx, iPlanet과 같은 모든 웹 서버에 공통적으로 제공되는 기능이다.
* 서버에 어떤 사용자가 어떤 요청을 하였고, 결과는 어떠한지 파일에 한 줄씩 쌓아준다.
* 한 화면을 구성하는 이미지, CSS, 자바스크립트, 플래시 파일 등 모든 파일에 대한 요청의 결과가 로그 파일에 쌓인다.
* 💡 **웹 로그가 어떻게 구성되어 있는지 아파치 웹 서버의 웹 로그 설정 부분을 참고하여 알아보자**
  * `httpd.conf`파일
    * LogFormat "%h %l %u %t \"%r\" %>s %b" common
    * ex) 127.0.0.1 - - [22/Oct/20XX:14:04:43 +0900] "GET /a.gif HTTP/1.1" 200 2326
      * 127.0.0.1 (%h): 서버에 요청을 한 클라이언트(원격 호스트)의 IP 주소이다.
      * - (%l): '-'로 표시되어 있기 때문에 요청한 정보가 없음을 의미한다. identd라는 사용자 인식 데몬이 클라이언트에서 동작하고 있을 경우에만 이 정보가 나타난다.
      * - (%u): HTTP 인증을 통하여 확인된 문서를 요청한 사용자의 ID가 표시된다.
      * [22/Oct/20XX:14:04:43 +0900] (%t): 서버가 요청을 마친 시간이다. [날짜/월/년:시:분:초 타임존]의 순서로 표시한다.
      * "GET /a.gif HTTP/1.1" (\"%r\"): 클라이언트에서 요청한 Request의 정보를 나타낸다.
      * 200 (%>s): 서버에서 클라이언트로 보낸 최종 상태 코드를 의미한다.
      * 2326 (%b): 클라이언트로 전송한 데이터의 크기가 표시된다.
* 🤔 **웹 로그만 보고 성능을 확인할 수 있을까?**
  * 로그 포맷에 `%D`, `%T`의 옵션을 추가해보자
    * `%D`: 요청의 처리 시간을 마이크로초 단위로 나타낸다.
    * `%T`: 요청의 처리 시간을 초 단위로 나타낸다.
* 🤔 **하루에도 몇 기가 바이트씩 증가하는 웹 로그를 어떻게 정리하고 있나..?**
  * 웹 로그 분석 툴을 사용해보자
    * Analog
    * AWStats
    * Webalizer
</br>

## ✏️ 웹 로그를 통해서 접근 통계를 분석하기 싫다면...
* 구글에서 제공하고 있는 `Google 애널리틱스`
  * 하지만 이 툴은 웹 로그 기반의 툴은 아니다.
  * 접근하는 모든 페이지에 정보를 전달하는 자바 스크립트 코드를 넣고 구글 서버에 데이터를 쌓는 방식
  * 그러므로, 모든 정보를 구글에 위치하기 때문에 회사의 사용량 정보가 유출될 우려가 있다.
* 이러한 문제를 해결하기 위해 만들어진 `Piwik`
  * 오픈소스로 제공되는 웹 페이지 접근 통계 툴
  * 플러그인을 제공한다.(Jenkins, Sonar)
</br>

## ✏️ 정리
* 웹 로그를 사용하면 그 동안 생각지도 못했던 문제점을 찾을 수도 있다.
* 많은 내용을 담고 있는 웹 로그를 그냥 방치하거나 삭제하지 말고 의미 있는 데이터가 될 수 있도록 최대한 활용하자.

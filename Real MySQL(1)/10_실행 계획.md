## 🦅 10.1 통계 정보
MySQL 서버는 5.7 버전까지 테이블과 인덱스에 대한 개괄적인 정보를 가지고 실행 계획을 수립했다.   
하지만 이는 테이블 칼럼의 값들이 실제 어떻게 분포돼 있는지에 대한 정보가 없기 때문에 실행 계획의 정확도가 떨어지는 경우가 많았다.   
그래서 MySQL 8.0 버전부터는 인덱스되지 않은 칼럼들에 대해서도 데이터 분포도를 수집해서 저장하는 히스토그램 정보가 도입됐다.   
히스토그램이 도입됐다고 해서 기존의 테이블이나 인덱스의 통계 정보가 필요치 않은 것은 아니다.
### 테이블 및 인덱스 통계 정보
* **MySQL 서버의 통계 정보**
  * MySQL 5.5 버전까지는 각 테이블의 통계 정보가 메모리에만 관리되고, SHOW INDEX 명령으로만 테이블의 인덱스 칼럼의 분포도를 볼 수 있었다.
  * 이처럼 통계 정보가 메모리에 관리될 경우 MySQL 서버가 재시작되면 지금까지 수집된 통계 정보가 모두 사라진다.
  * MySQL 5.6 버전부터는 각 테이블의 통계 정보를 mysql 데이터베이스의 `innodb_index_stats` 테이블과 `innodb_table_stats` 테이블로 관리할 수 있게 개선됐다. 이렇게 통계 정보를 테이블로 관리함으로써 MySQL 서버가 재시작돼도 기존의 통계 정보를 유지할 수 있게 됐다.
### 히스토그램
* **히스토그램 정보 수집 및 삭제**
  * MySQL 8.0 버전에서 히스토그램 정보는 컬럼 단위로 관리되는데, 이는 자동으로 수집되지 않고 `ANALYZE TABLE ... UPDATE HISTOGRAM` 명령을 실행해 수동으로 수집 및 관리된다.
  * 수집된 히스토그램 정보는 시스템 딕셔너리에 함께 저장되고, MySQL 서버가 시작될 때 딕셔너리의 히스토그램 정보를 `information_schema` 데이터베이스의 `column_statistics` 테이블로 로드한다.
  * MySQL 8.0 버전에서는 2종류의 히스토그램 타입이 지원된다.
    * Singeton(싱글톤 히스토그램): 컬럼값 개별로 레코드 건수를 관리하는 히스토그램
    * Equi-Height(높이 균형 히스토그램): 컬럼값의 범위를 균등한 개수로 구분해서 관리하는 히스토그램
* **히스토그램의 용도**
  * MySQL 서버의 `기존 통계 정보를 데이터가 항상 균등한 분포도를 가지지 않는 점`을 고려하지 못했다.
  * 이러한 단점을 보완하기 위해 히스토그램이 도입됐다. 히스토그램 정보가 없으면 옵티마이저는 데이터가 균등하게 분포돼 있을 것으로 예측한다.
  * 히스토그램은 특정 컬럼이 가지는 모든 값에 대한 분포도 정보를 가지지는 않지만 각 범위(버킷)별로 레코드의 건수와 유니크한 값의 개수 정보를 가지기 때문에 훨씬 정확한 예측을 할 수 있다.
* **히스토그램과 인덱스**
  * ✏️`인덱스 다이브`: 옵티마이저가 쿼리 실행 계획을 생성할 때 인덱스의 통계 데이터를 세부적으로 조사하는 과정이다. 이를 통해 옵티마이저는 쿼리 성능을 최적화하기 위해 특정 인덱스를 사용할지 여부를 결정한다.
### 코스트 모델(Cost Model)

## 🦅 10.2 실행 계획 확인
### 실행 계획 출력 포맷
### 쿼리의 실행 시간 확인

## 🦅 10.3 실행 계획 분석
### id 칼럼
### select_type 칼럼
* **SIMPLE**
* **PRIMARY**
* **UNION**
* **DEPENDENT UNION**
* **UNION RESULT**
* **SUBQUERY**
* **DEPENDENT SUBQUERY**
* **DERIVED**
* **DEPENDENT DERIVED**
* **UNCHACHEABLE SUBQUERY**
* **UNCACHEABLE UNION**
* **MATERIALIZED**
### table 칼럼
### partitions 칼럼
### type 칼럼
* **system**
* **const**
* **eq_ref**
* **ref**
* **fulltext**
* **ref_or_null**
* **unique_subquery**
* **index_subquery**
* **range**
* **index_merge**
* **index**
* **ALL**
